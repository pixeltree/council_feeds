# Calgary Council Stream Recorder Configuration

# Recording Resilience Settings
# ==============================

# Recording format: mkv (safest), mp4, or ts
# MKV (Matroska) is the most resilient format - can be played even if recording is interrupted
# MP4 requires proper closing - use fragmented MP4 mode for better resilience
# TS (MPEG Transport Stream) is also very resilient but larger files
RECORDING_FORMAT=mkv

# Enable segmented recording (records in chunks, e.g., 15-minute segments)
# This ensures you never lose more than one segment if something goes wrong
# Segments are automatically merged after recording completes
ENABLE_SEGMENTED_RECORDING=true

# Segment duration in seconds (default: 900 = 15 minutes)
SEGMENT_DURATION=900

# Enable automatic reconnection if stream has issues
# Helps maintain recording even if there are brief network interruptions
RECORDING_RECONNECT=true

# Post-Processing Settings
# =========================

# Enable automatic post-processing to split recordings by silence
ENABLE_POST_PROCESSING=true

# Silence threshold in dB (more negative = stricter)
POST_PROCESS_SILENCE_THRESHOLD_DB=-40

# Minimum silence duration to consider as a break (in seconds)
POST_PROCESS_MIN_SILENCE_DURATION=120

# Transcription Settings
# =======================

# Enable automatic transcription with speaker diarization
ENABLE_TRANSCRIPTION=false

# pyannote.ai API token (required for transcription + speaker diarization)
# Get one at https://www.pyannote.ai/
# Uses pyannote STT Orchestration - performs transcription AND diarization in one cloud API call
PYANNOTE_API_TOKEN=

# Speaker segmentation threshold (0.0-1.0, default: 0.3)
# Lower values = more sensitive, detects more speakers (try 0.3-0.4 for more speakers)
# Higher values = less sensitive, fewer speakers (try 0.6-0.7 for fewer speakers)
PYANNOTE_SEGMENTATION_THRESHOLD=0.3

# Gemini API Settings (optional - improves speaker identification)
# =================================================================

# Google Gemini API key for speaker diarization refinement
# This feature uses Gemini AI to improve speaker labels by using meeting agenda context
# to map generic labels (SPEAKER_00, SPEAKER_01) to real names (e.g., "Mayor Jyoti Gondek")
# Get a free API key at https://aistudio.google.com/app/apikey
GEMINI_API_KEY=

# Gemini model to use (default: gemini-1.5-flash)
# Available models: gemini-1.5-flash (fast, cheap), gemini-1.5-pro (more accurate)
GEMINI_MODEL=gemini-1.5-flash

# Enable/disable Gemini refinement (default: true if API key is set)
# Set to false to disable even if you have an API key
ENABLE_GEMINI_REFINEMENT=true

# General Settings
# ================

# Output directory for recordings
OUTPUT_DIR=./recordings

# Database directory
DB_DIR=./data

# Web server settings
WEB_HOST=0.0.0.0
WEB_PORT=5000

# FFmpeg path (leave as 'ffmpeg' to use system default)
FFMPEG_COMMAND=ffmpeg

# yt-dlp path (leave as 'yt-dlp' to use system default)
YTDLP_COMMAND=yt-dlp
