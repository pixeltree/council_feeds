<!DOCTYPE html>
<html>
<head>
    <title>Calgary Council Stream Recorder</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse-animation {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .pulse-dot {
            animation: pulse-animation 2s ease-in-out infinite;
        }
    </style>
    <script>
        // Auto-refresh every 10 seconds
        setTimeout(() => location.reload(), 10000);
    </script>
</head>
<body class="bg-gradient-to-br from-indigo-500 to-purple-600 min-h-screen p-5">
    <div class="max-w-6xl mx-auto">
        <!-- Header -->
        <div class="bg-white rounded-xl p-8 mb-5 shadow-lg flex flex-col md:flex-row justify-between items-center gap-4">
            <div>
                <h1 class="text-gray-800 text-3xl md:text-4xl font-bold mb-2">Calgary Council Stream Recorder</h1>
                <p class="text-gray-600 text-lg">Real-time monitoring and recording of Calgary City Council meetings</p>
            </div>
            <a href="/recordings" class="text-indigo-600 font-semibold px-4 py-2 rounded-lg hover:bg-gray-50 transition whitespace-nowrap">
                ðŸ“¹ View All Recordings
            </a>
        </div>

        <!-- Current Status Card -->
        <div class="bg-white rounded-xl p-6 mb-5 shadow-lg">
            <h2 class="text-gray-800 text-2xl font-bold mb-4 pb-3 border-b-2 border-gray-200">Current Status</h2>
            {% if current_recording %}
                <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-red-100 text-red-700 font-semibold text-sm">
                    <span class="w-2.5 h-2.5 rounded-full bg-red-700 pulse-dot"></span>
                    RECORDING IN PROGRESS
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                    <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-indigo-600">
                        <div class="text-gray-600 text-sm mb-1">Recording Since</div>
                        <div class="text-gray-800 text-xl font-bold">{{ current_recording.start_time }}</div>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-indigo-600">
                        <div class="text-gray-600 text-sm mb-1">Meeting</div>
                        <div class="text-gray-800 text-base font-bold">{{ current_recording.meeting_title or 'Unscheduled' }}</div>
                    </div>
                </div>
            {% else %}
                <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-green-100 text-green-700 font-semibold text-sm">
                    <span class="w-2.5 h-2.5 rounded-full bg-green-700 pulse-dot"></span>
                    MONITORING
                </div>
                <p class="mt-4 text-gray-600">System is actively monitoring for live streams</p>
            {% endif %}
        </div>

        <!-- Recording Statistics Card -->
        <div class="bg-white rounded-xl p-6 mb-5 shadow-lg">
            <h2 class="text-gray-800 text-2xl font-bold mb-4 pb-3 border-b-2 border-gray-200">Recording Statistics</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-indigo-600">
                    <div class="text-gray-600 text-sm mb-1">Total Recordings</div>
                    <div class="text-gray-800 text-3xl font-bold">{{ stats.total_recordings }}</div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-indigo-600">
                    <div class="text-gray-600 text-sm mb-1">Completed</div>
                    <div class="text-gray-800 text-3xl font-bold">{{ stats.completed }}</div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-indigo-600">
                    <div class="text-gray-600 text-sm mb-1">Failed</div>
                    <div class="text-gray-800 text-3xl font-bold">{{ stats.failed }}</div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-indigo-600">
                    <div class="text-gray-600 text-sm mb-1">Total Size</div>
                    <div class="text-gray-800 text-3xl font-bold">{{ stats.total_size_gb }} GB</div>
                </div>
            </div>
        </div>

        <!-- Upcoming Meetings Card -->
        <div class="bg-white rounded-xl p-6 mb-5 shadow-lg">
            <h2 class="text-gray-800 text-2xl font-bold mb-4 pb-3 border-b-2 border-gray-200">Upcoming Meetings</h2>
            {% if meetings %}
                <ul class="space-y-2">
                    {% for meeting in meetings %}
                    <li class="p-4 bg-gray-50 rounded-lg border-l-4 border-indigo-600">
                        <div class="text-gray-800 font-semibold mb-1">{{ meeting.title }}</div>
                        <div class="text-gray-600 text-sm">{{ meeting.raw_date }}</div>
                    </li>
                    {% endfor %}
                </ul>
            {% else %}
                <div class="text-center py-10 text-gray-500">
                    <p>No upcoming meetings scheduled</p>
                </div>
            {% endif %}
        </div>

        <!-- Recent Recordings Card -->
        <div class="bg-white rounded-xl p-6 mb-5 shadow-lg">
            <h2 class="text-gray-800 text-2xl font-bold mb-4 pb-3 border-b-2 border-gray-200">Recent Recordings</h2>
            {% if recordings %}
                {% for recording in recordings %}
                <div class="p-4 mb-2 bg-gray-50 rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3">
                    <div class="flex-1">
                        <div class="text-gray-800 font-semibold mb-1">{{ recording.meeting_title or 'Council Meeting' }}</div>
                        <div class="text-gray-600 text-sm">
                            {{ recording.start_time }}
                            {% if recording.duration_seconds %}
                                â€¢ Duration: {{ recording.duration_minutes }} min
                            {% endif %}
                            {% if recording.file_size_mb %}
                                â€¢ Size: {{ recording.file_size_mb }} MB
                            {% endif %}
                        </div>
                    </div>
                    <span class="px-3 py-1 rounded-full text-xs font-semibold
                        {% if recording.status == 'completed' %}bg-green-100 text-green-700
                        {% elif recording.status == 'failed' %}bg-red-100 text-red-700
                        {% else %}bg-orange-100 text-orange-700{% endif %}">
                        {{ recording.status.upper() }}
                    </span>
                </div>
                {% endfor %}
            {% else %}
                <div class="text-center py-10 text-gray-500">
                    <p>No recordings yet</p>
                </div>
            {% endif %}
        </div>

        <!-- Footer -->
        <div class="text-right text-gray-100 text-sm mt-3">
            Page auto-refreshes every 10 seconds â€¢ Last updated: {{ now }}
        </div>
    </div>
</body>
</html>
